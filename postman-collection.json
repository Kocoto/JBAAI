{
  "info": {
    "_postman_id": "jbaai-api-collection-v2",
    "name": "JBAAI API Collection - Complete Version",
    "description": "Collection đầy đủ và chi tiết cho JBAAI API bao gồm tất cả các endpoints: Authentication, User Management, Profile, Health Data, Package, PayPal Payment, Upgrade Request, Invitation Code, Admin APIs, Franchise APIs, Report và các utilities",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{accessToken}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "accessToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "refreshToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "packageId",
      "value": "",
      "type": "string"
    },
    {
      "key": "orderId",
      "value": "",
      "type": "string"
    },
    {
      "key": "purchaseHistoryId",
      "value": "",
      "type": "string"
    },
    {
      "key": "upgradeRequestId",
      "value": "",
      "type": "string"
    },
    {
      "key": "campaignId",
      "value": "",
      "type": "string"
    },
    {
      "key": "healthDataId",
      "value": "",
      "type": "string"
    },
    {
      "key": "franchiseUserId",
      "value": "",
      "type": "string"
    },
    {
      "key": "childFranchiseUserId",
      "value": "",
      "type": "string"
    },
    {
      "key": "ledgerEntryId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "1. Authentication",
      "item": [
        {
          "name": "Register",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data._id) {",
                  "        pm.collectionVariables.set('userId', response.data._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"test@example.com\",\n    \"password\": \"StrongPassword123\",\n    \"username\": \"testuser\",\n    \"phone\": \"0901234567\",\n    \"role\": \"user\",\n    \"invitationCode\": \"AQP FREE15\",\n    \"optionEmail\": \"option@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/register",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "register"]
            },
            "description": "Đăng ký tài khoản mới. Nếu có mã mời 'AQP FREE15' sẽ được tặng gói standard. Role có thể là: user, franchise, admin"
          }
        },
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data) {",
                  "        pm.collectionVariables.set('accessToken', response.data.accessToken);",
                  "        pm.collectionVariables.set('refreshToken', response.data.refreshToken);",
                  "        pm.collectionVariables.set('userId', response.data.user._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"test@example.com\",\n    \"password\": \"StrongPassword123\",\n    \"clientId\": \"web-app-v1\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            },
            "description": "Đăng nhập bằng email và password"
          }
        },
        {
          "name": "Login with JBA",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login-with-jba?code=example_code&state=example_state",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login-with-jba"],
              "query": [
                {
                  "key": "code",
                  "value": "example_code"
                },
                {
                  "key": "state",
                  "value": "example_state"
                }
              ]
            },
            "description": "Đăng nhập thông qua JBA OAuth"
          }
        },
        {
          "name": "Get OTP",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"test@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/resend-otp",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "resend-otp"]
            },
            "description": "Gửi mã OTP đến email"
          }
        },
        {
          "name": "Verify OTP to Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data) {",
                  "        pm.collectionVariables.set('accessToken', response.data.accessToken);",
                  "        pm.collectionVariables.set('refreshToken', response.data.refreshToken);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"test@example.com\",\n    \"otp\": \"123456\",\n    \"clientId\": \"web-app-v1\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/verify-otp-to-login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "verify-otp-to-login"]
            },
            "description": "Xác thực OTP để đăng nhập"
          }
        },
        {
          "name": "Verify OTP to Reset Password",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"otp\": \"123456\",\n    \"email\": \"test@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/verify-otp-to-reset-password",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "verify-otp-to-reset-password"]
            },
            "description": "Xác thực OTP để reset mật khẩu"
          }
        },
        {
          "name": "Reset Password",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"test@example.com\",\n    \"newPassword\": \"NewStrongPassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/reset-password",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "reset-password"]
            },
            "description": "Reset mật khẩu sau khi đã xác thực OTP"
          }
        },
        {
          "name": "Change Password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"oldPassword\": \"StrongPassword123\",\n    \"newPassword\": \"NewStrongPassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/change-password",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "change-password"]
            },
            "description": "Thay đổi mật khẩu (yêu cầu đăng nhập)"
          }
        },
        {
          "name": "Refresh Token",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.token) {",
                  "        pm.collectionVariables.set('accessToken', response.token.accessToken);",
                  "        pm.collectionVariables.set('refreshToken', response.token.refreshToken);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"refreshToken\": \"{{refreshToken}}\",\n    \"clientId\": \"web-app-v1\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/refresh-token",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "refresh-token"]
            },
            "description": "Làm mới access token"
          }
        },
        {
          "name": "Logout",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"refreshToken\": \"{{refreshToken}}\",\n    \"clientId\": \"web-app-v1\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/logout",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "logout"]
            },
            "description": "Đăng xuất"
          }
        }
      ]
    },
    {
      "name": "2. User Management",
      "item": [
        {
          "name": "Switch Email Notification",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/user/switch-notification",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user", "switch-notification"]
            },
            "description": "Bật/tắt thông báo email"
          }
        },
        {
          "name": "Change Language",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"language\": \"vi\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/user/change-language",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user", "change-language"]
            },
            "description": "Thay đổi ngôn ngữ. Các giá trị hợp lệ: vn, en, in, cn"
          }
        },
        {
          "name": "Update Many Users (Test)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/user/test",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "user", "test"]
            },
            "description": "API test để update nhiều users"
          }
        }
      ]
    },
    {
      "name": "3. Profile",
      "item": [
        {
          "name": "Get Profile",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/profile",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "profile"]
            },
            "description": "Lấy thông tin profile của user"
          }
        },
        {
          "name": "Update Profile",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"height\": 170,\n    \"weight\": 65,\n    \"age\": 25,\n    \"gender\": \"male\",\n    \"smokingStatus\": 0\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/profile/update",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "profile", "update"]
            },
            "description": "Cập nhật thông tin profile"
          }
        }
      ]
    },
    {
      "name": "4. Health Data",
      "item": [
        {
          "name": "Get Health Data by Date",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.length > 0) {",
                  "        pm.collectionVariables.set('healthDataId', response.data[0]._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"createdAt\": \"2025-01-20\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/health-data",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "health-data"]
            },
            "description": "Lấy dữ liệu sức khỏe theo ngày cụ thể"
          }
        },
        {
          "name": "Create Health Data",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"bpValue\": {\n        \"diastolic\": 80,\n        \"systolic\": 120\n    },\n    \"pulseRate\": {\n        \"value\": 70\n    },\n    \"oxygenSaturation\": {\n        \"value\": 98\n    },\n    \"wellnessLevel\": {\n        \"value\": 3\n    },\n    \"wellnessIndex\": {\n        \"value\": 85\n    },\n    \"pulseWaveVelocity\": {\n        \"value\": 7.5\n    },\n    \"bioPPG\": {\n        \"value\": 2\n    },\n    \"hrvLevel\": {\n        \"value\": 3\n    },\n    \"hrvIndex\": {\n        \"value\": 56\n    },\n    \"stressLevel\": {\n        \"value\": 1\n    },\n    \"stressIndex\": {\n        \"value\": 49\n    }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/health-data/update",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "health-data", "update"]
            },
            "description": "Tạo dữ liệu sức khỏe mới"
          }
        },
        {
          "name": "Get Health Data by Date Range",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"type\": \"week\",\n    \"data\": \"1/2025\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/health-data/get-health-data-by-range",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "health-data", "get-health-data-by-range"]
            },
            "description": "Lấy dữ liệu sức khỏe theo khoảng thời gian. Type: day, week, month"
          }
        },
        {
          "name": "Send Health Data Email",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept-Language",
                "value": "vi"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"healthData\": {\n        \"bpValue\": {\n            \"diastolic\": 74,\n            \"systolic\": 117\n        },\n        \"pulseRate\": {\n            \"value\": 55\n        },\n        \"oxygenSaturation\": {\n            \"value\": 98\n        },\n        \"wellnessLevel\": {\n            \"value\": 3\n        },\n        \"wellnessIndex\": {\n            \"value\": 9\n        }\n    }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/health-data/sent-mail",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "health-data", "sent-mail"]
            },
            "description": "Gửi email báo cáo sức khỏe"
          }
        },
        {
          "name": "Delete Health Data",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"healthDataId\": \"{{healthDataId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/health-data/delete",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "health-data", "delete"]
            },
            "description": "Xóa dữ liệu sức khỏe"
          }
        }
      ]
    },
    {
      "name": "5. Package",
      "item": [
        {
          "name": "Get All Packages",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.length > 0) {",
                  "        pm.collectionVariables.set('packageId', response.data[0]._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/package",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "package"]
            },
            "description": "Lấy tất cả packages (dựa trên IP để xác định location)"
          }
        },
        {
          "name": "Get Package by Type",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"type\": \"premium\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/package/get-by-type",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "package", "get-by-type"]
            },
            "description": "Lấy package theo loại (standard hoặc premium)"
          }
        },
        {
          "name": "Get Package by ID",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/package/{{packageId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "package", "{{packageId}}"]
            },
            "description": "Lấy thông tin chi tiết package"
          }
        },
        {
          "name": "Create Package",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"name\": \"Premium Monthly\",\n    \"price\": 10,\n    \"description\": \"Premium package with all features\",\n    \"duration\": 30,\n    \"type\": \"premium\",\n    \"location\": \"VN\",\n    \"discount\": 2,\n    \"status\": true\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/package/create",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "package", "create"]
            },
            "description": "Tạo package mới (yêu cầu đăng nhập)"
          }
        }
      ]
    },
    {
      "name": "6. PayPal Payment",
      "item": [
        {
          "name": "Create PayPal Order",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data.order && response.data.order.result) {",
                  "        pm.collectionVariables.set('orderId', response.data.order.result.id);",
                  "        pm.collectionVariables.set('purchaseHistoryId', response.data.newPurchase._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"packageId\": \"{{packageId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/paypal/create-order",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "paypal", "create-order"]
            },
            "description": "Tạo đơn hàng PayPal"
          }
        },
        {
          "name": "Capture PayPal Order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"orderId\": \"{{orderId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/paypal/capture-order",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "paypal", "capture-order"]
            },
            "description": "Xác nhận thanh toán PayPal"
          }
        }
      ]
    },
    {
      "name": "7. Upgrade Request",
      "item": [
        {
          "name": "Create Upgrade Request",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    if (response.data && response.data._id) {",
                  "        pm.collectionVariables.set('upgradeRequestId', response.data._id);",
                  "    }",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"packageId\": \"{{packageId}}\",\n    \"description\": \"Yêu cầu nâng cấp gói premium\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/upgrade-request/create",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "upgrade-request", "create"]
            },
            "description": "Tạo yêu cầu nâng cấp gói"
          }
        },
        {
          "name": "Get Pending Upgrade Requests",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/upgrade-request/pending",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "upgrade-request", "pending"]
            },
            "description": "Lấy danh sách yêu cầu đang chờ xử lý"
          }
        },
        {
          "name": "Accept Upgrade Request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"upgradeRequestId\": \"{{upgradeRequestId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/upgrade-request/accept-by-seller",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "upgrade-request", "accept-by-seller"]
            },
            "description": "Seller nhận xử lý yêu cầu nâng cấp"
          }
        },
        {
          "name": "Get Upgrade Requests by Seller ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/upgrade-request/get-by-seller-id/reviewing",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "v1",
                "upgrade-request",
                "get-by-seller-id",
                "reviewing"
              ]
            },
            "description": "Lấy danh sách yêu cầu mà seller đang xử lý"
          }
        },
        {
          "name": "Approve Upgrade Request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/upgrade-request/{{upgradeRequestId}}/approve",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "v1",
                "upgrade-request",
                "{{upgradeRequestId}}",
                "approve"
              ]
            },
            "description": "Phê duyệt yêu cầu nâng cấp"
          }
        }
      ]
    },
    {
      "name": "8. Invitation Code",
      "item": [
        {
          "name": "Get Invitation Code by User",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/invitation-code",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "invitation-code"]
            },
            "description": "Lấy mã mời của user hiện tại"
          }
        }
      ]
    },
    {
      "name": "9. Franchise APIs",
      "item": [
        {
          "name": "My Franchise Info",
          "item": [
            {
              "name": "Get My Franchise Details",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/me/details",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "franchise", "me", "details"]
                },
                "description": "Lấy thông tin FranchiseDetails của franchise đang đăng nhập"
              }
            },
            {
              "name": "Get My Quota",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/me/quota",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "franchise", "me", "quota"]
                },
                "description": "Lấy thông tin quota hiện tại"
              }
            },
            {
              "name": "Get My Statistics",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/me/statistics",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "franchise", "me", "statistics"]
                },
                "description": "Lấy thống kê hiệu suất"
              }
            },
            {
              "name": "Get My Invitation Codes",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/me/invitation-codes",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "franchise", "me", "invitation-codes"]
                },
                "description": "Lấy danh sách các mã mời"
              }
            },
            {
              "name": "Get My User Trial Quota Ledger",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/me/user-trial-quota-ledger?status=active",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "me",
                    "user-trial-quota-ledger"
                  ],
                  "query": [
                    {
                      "key": "status",
                      "value": "active",
                      "description": "Filter by status: active, inactive, expired"
                    },
                    {
                      "key": "rootCampaignId",
                      "value": "{{campaignId}}",
                      "description": "Filter by campaign ID",
                      "disabled": true
                    }
                  ]
                },
                "description": "Lấy danh sách quota ledger"
              }
            }
          ]
        },
        {
          "name": "Manage Children Quota",
          "item": [
            {
              "name": "Allocate Quota to Child",
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"childFranchiseUserId\": \"{{childFranchiseUserId}}\",\n    \"amountToAllocate\": 10,\n    \"sourceLedgerEntryId\": \"{{ledgerEntryId}}\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/manage-children-quota/allocate",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "manage-children-quota",
                    "allocate"
                  ]
                },
                "description": "Cấp quota cho franchise con"
              }
            },
            {
              "name": "Revoke Quota from Child",
              "request": {
                "method": "PUT",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/manage-children-quota/revoke-allocation/{{ledgerEntryId}}",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "manage-children-quota",
                    "revoke-allocation",
                    "{{ledgerEntryId}}"
                  ]
                },
                "description": "Thu hồi quota từ franchise con"
              }
            },
            {
              "name": "Get Child Allocation History",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/manage-children-quota/allocation-history/child/{{childFranchiseUserId}}",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "manage-children-quota",
                    "allocation-history",
                    "child",
                    "{{childFranchiseUserId}}"
                  ]
                },
                "description": "Lịch sử cấp phát quota cho franchise con cụ thể"
              }
            }
          ]
        },
        {
          "name": "Reports",
          "item": [
            {
              "name": "Get My Trial Performance",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/reports/my-trial-performance",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "reports",
                    "my-trial-performance"
                  ]
                },
                "description": "Hiệu suất mời dùng thử của chính mình"
              }
            },
            {
              "name": "Get Children Trial Performance Summary",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/reports/children-trial-performance-summary",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "reports",
                    "children-trial-performance-summary"
                  ]
                },
                "description": "Hiệu suất tổng hợp franchise con"
              }
            },
            {
              "name": "Get Single Child Trial Performance",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/reports/child-trial-performance/{{childFranchiseUserId}}",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "reports",
                    "child-trial-performance",
                    "{{childFranchiseUserId}}"
                  ]
                },
                "description": "Hiệu suất chi tiết một franchise con"
              }
            },
            {
              "name": "Get Full Hierarchy Performance",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/reports/full-hierarchy-performance",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "reports",
                    "full-hierarchy-performance"
                  ]
                },
                "description": "Hiệu suất toàn bộ cây franchise"
              }
            },
            {
              "name": "Get Full Hierarchy Performance by Campaign",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/reports/full-hierarchy-performance/{{campaignId}}",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "reports",
                    "full-hierarchy-performance",
                    "{{campaignId}}"
                  ]
                },
                "description": "Hiệu suất toàn bộ cây franchise theo campaign"
              }
            },
            {
              "name": "Get Quota Utilization",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/franchise/reports/quota-utilization",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "franchise",
                    "reports",
                    "quota-utilization"
                  ]
                },
                "description": "Tình hình sử dụng quota"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "10. Admin APIs",
      "item": [
        {
          "name": "Campaigns",
          "item": [
            {
              "name": "Create Campaign",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 201) {",
                      "    const response = pm.response.json();",
                      "    if (response.data && response.data._id) {",
                      "        pm.collectionVariables.set('campaignId', response.data._id);",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"campaignName\": \"Campaign Q1 2025\",\n    \"franchiseOwnerId\": \"{{userId}}\",\n    \"totalAllocated\": 100,\n    \"startDate\": \"2025-01-01\",\n    \"endDate\": \"2025-03-31\",\n    \"renewalRequirement\": 20\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "campaigns"]
                },
                "description": "Tạo campaign mới (Admin only)"
              }
            },
            {
              "name": "Get All Campaigns",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns?status=active&page=1&limit=10",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "campaigns"],
                  "query": [
                    {
                      "key": "status",
                      "value": "active",
                      "description": "Filter by status: active, inactive, expired"
                    },
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "limit",
                      "value": "10"
                    }
                  ]
                },
                "description": "Lấy danh sách campaigns với phân trang"
              }
            },
            {
              "name": "Get Campaign by ID",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns/{{campaignId}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "campaigns", "{{campaignId}}"]
                },
                "description": "Lấy thông tin chi tiết campaign"
              }
            },
            {
              "name": "Update Campaign",
              "request": {
                "method": "PUT",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"campaignName\": \"Updated Campaign Q1 2025\",\n    \"totalAllocated\": 150,\n    \"renewalRequirement\": 25\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns/{{campaignId}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "campaigns", "{{campaignId}}"]
                },
                "description": "Cập nhật thông tin campaign"
              }
            },
            {
              "name": "Change Campaign Status",
              "request": {
                "method": "PATCH",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n    \"status\": \"inactive\"\n}"
                },
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns/{{campaignId}}/status",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "admin",
                    "campaigns",
                    "{{campaignId}}",
                    "status"
                  ]
                },
                "description": "Thay đổi trạng thái campaign (active, inactive, expired)"
              }
            },
            {
              "name": "Delete Campaign",
              "request": {
                "method": "DELETE",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns/{{campaignId}}",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "campaigns", "{{campaignId}}"]
                },
                "description": "Xóa campaign (soft delete)"
              }
            },
            {
              "name": "Get Campaign Statistics",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns/statistics",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "campaigns", "statistics"]
                },
                "description": "Lấy thống kê campaigns"
              }
            },
            {
              "name": "Get Campaign Performance Summary",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/campaigns/{{campaignId}}/performance-summary",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "admin",
                    "campaigns",
                    "{{campaignId}}",
                    "performance-summary"
                  ]
                },
                "description": "Lấy tổng quan hiệu suất của campaign"
              }
            }
          ]
        },
        {
          "name": "Franchise Management",
          "item": [
            {
              "name": "Get All Franchises",
              "event": [
                {
                  "listen": "test",
                  "script": {
                    "exec": [
                      "if (pm.response.code === 200) {",
                      "    const response = pm.response.json();",
                      "    if (response.data && response.data.franchises && response.data.franchises.length > 0) {",
                      "        pm.collectionVariables.set('franchiseUserId', response.data.franchises[0].userId);",
                      "    }",
                      "}"
                    ],
                    "type": "text/javascript"
                  }
                }
              ],
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/franchises?page=1&limit=10&status=active&franchiseLevel=1",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "admin", "franchises"],
                  "query": [
                    {
                      "key": "page",
                      "value": "1"
                    },
                    {
                      "key": "limit",
                      "value": "10"
                    },
                    {
                      "key": "status",
                      "value": "active",
                      "description": "Filter by user status"
                    },
                    {
                      "key": "franchiseLevel",
                      "value": "1",
                      "description": "Filter by franchise level"
                    }
                  ]
                },
                "description": "Lấy danh sách tất cả franchises"
              }
            },
            {
              "name": "Get Franchise Hierarchy",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/franchises/{{franchiseUserId}}/hierarchy",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "admin",
                    "franchises",
                    "{{franchiseUserId}}",
                    "hierarchy"
                  ]
                },
                "description": "Lấy cây phân cấp của franchise"
              }
            },
            {
              "name": "Get Franchise Performance Overview",
              "request": {
                "method": "GET",
                "url": {
                  "raw": "{{baseUrl}}/api/v1/admin/franchises/{{franchiseUserId}}/performance-overview",
                  "host": ["{{baseUrl}}"],
                  "path": [
                    "api",
                    "v1",
                    "admin",
                    "franchises",
                    "{{franchiseUserId}}",
                    "performance-overview"
                  ]
                },
                "description": "Lấy tổng quan hiệu suất của franchise"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "11. Report",
      "item": [
        {
          "name": "Export Revenue Report",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/report/revenue",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "report", "revenue"]
            },
            "description": "Export báo cáo doanh thu"
          }
        }
      ]
    },
    {
      "name": "12. Home & Utilities",
      "item": [
        {
          "name": "Home",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/",
              "host": ["{{baseUrl}}"],
              "path": [""]
            },
            "description": "API home endpoint"
          }
        },
        {
          "name": "Test GeoIP",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/test",
              "host": ["{{baseUrl}}"],
              "path": ["test"]
            },
            "description": "Test GeoIP functionality"
          }
        },
        {
          "name": "Hide Score",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/hide-score",
              "host": ["{{baseUrl}}"],
              "path": ["hide-score"]
            },
            "description": "Hide score endpoint"
          }
        },
        {
          "name": "Payment Success Page",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/payment-success",
              "host": ["{{baseUrl}}"],
              "path": ["payment-success"]
            },
            "description": "Payment success page"
          }
        },
        {
          "name": "Payment Fail Page",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/payment-fail",
              "host": ["{{baseUrl}}"],
              "path": ["payment-fail"]
            },
            "description": "Payment fail page"
          }
        },
        {
          "name": "API Documentation",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api-docs",
              "host": ["{{baseUrl}}"],
              "path": ["api-docs"]
            },
            "description": "Swagger API documentation"
          }
        }
      ]
    }
  ]
}
